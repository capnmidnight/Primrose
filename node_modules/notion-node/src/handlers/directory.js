var fs = require("fs"),
  path = require("path"),
  sendHTML = require("./sendHTML");

module.exports = function directory(dirPath, root) {
  var link = function link(a, b) {
    return "<li><a href=\"" + a + "\">" + b + "</a></li>";
  };

  var files = fs.readdirSync(dirPath),
      links = [],
      parent = path.dirname(dirPath);
  if (parent !== ".") {
    links.push(link("..", ".."));
  }
  for (var i = 0; i < files.length; ++i) {
    var file = files[i];
    var subPath = path.join(dirPath, file);
    var stats = fs.lstatSync(subPath);
    if (!/^[$.]/.test(file) && (stats.isDirectory() || /\.html$/.test(file))) {
      links.push(link(file, file));
    }
  }
  return sendHTML("<ul>" + links.join("\n") + "</ul>");
};