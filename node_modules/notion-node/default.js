var opts = require("./src/options"),
  http = require("http"),
  path = require("path"),
  setupWebServer = require("./src/setupWebServer");

var options = Object.assign({
  path: "..",
  port: process.env.PORT || 80,
  url: path.parse(process.cwd()).name
}, opts.parse(process.argv)),
  webServer = setupWebServer(options.path);

options.port = parseFloat(options.port);

console.log("Serving from directory " + options.path);
console.log("Listening on port " + options.port);

var appServer = http.createServer(webServer)
appServer.listen(options.port);

// start the browser
require("./src/starter")(false, options.port, options.url);