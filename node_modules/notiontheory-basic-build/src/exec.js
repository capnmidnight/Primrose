var pexec = require("child_process").exec;

function fwd(name){
  return function(data){
    console[name](data.toString("utf8"));
  };
}

function exec(cmd, cb2) {
  var thunk = function(cb) {
    var proc = pexec(cmd, { encoding: "utf8" }, cb);
    proc.stdout.on("data", fwd("log"));
    proc.stderr.on("data", fwd("error"));
  };

  if(cb2){
    thunk = thunk(cb2);
  }

  return thunk;
}

module.exports = exec;