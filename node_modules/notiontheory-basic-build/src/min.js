var rename = require("gulp-rename"),
  minify = require("gulp-uglify"),
  work = require("./work"),
  echoName = require("./echoName"),
  defaultBase = {
    base: "./"
  },
  defaultRename = {
    suffix: ".min"
  },
  fs = require("fs");

function min(gulp, pkg, name, files, dependencies, post){
  return work(gulp, "min", null,
    () => gulp.src(files, defaultBase)
      .pipe(echoName("minifying"))
      .pipe(minify()
        .on("error", console.error.bind(console, "uglify error")))
      .pipe(rename(defaultRename))
      .pipe(gulp.dest("./")),
    name, files, dependencies, post);
}

module.exports = min;