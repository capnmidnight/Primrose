function Cursor(a,b,c){this.i=a||0,this.x=b||0,this.y=c||0,this.moved=!1}function Grammar(a,b){this.name=a,this.grammar=b.map(function(a){return new Rule(a[0],a[1])})}function Rule(a,b){this.name=a,this.test=b}function Token(a,b,c){this.value=a,this.type=b,this.index=c}function Primrose(a,b){"use strict";function c(a,b,c){var d=a-b,e=a-c+5,f=0;return d>=0&&0>e||(f=Math.abs(d)<Math.abs(e)?d:e),f}function d(a){var b=a.clipboardData.types.indexOf("text/plain");if(0>b)for(b=0;b<a.clipboardData.types.length&&!/^text/.test(a.clipboardData.types[b]);++b);if(b>=0){var c=a.clipboardData.types[b],d=a.clipboardData.getData(c);a.preventDefault(),p.pasteAtCursor(d)}}function e(){var a=p.getPixelRatio(),b=p.characterWidth,c=p.characterHeight,d=V.width,e=V.height,f=W.font;p.characterHeight=x.fontSize*a,V.width=V.clientWidth*a,V.height=V.clientHeight*a,W.font=p.characterHeight+"px "+x.fontFamily,p.characterWidth=W.measureText("MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM").width/100,Q=b!==p.characterWidth||c!==p.characterHeight||d!==V.width||e!==V.height||f!==W.font,p.drawText()}function f(a,b,c){Q=!0,B=b,C=c;var d=p.getLines(),e=p.pixel2cell(b,c);a.setXY(e.x,e.y,d)}function g(a,b){if(P&&0===b.button){var c=a.getBoundingClientRect();p.startPointer(b.clientX-c.left,b.clientY-c.top),b.preventDefault()}}function h(a,b){if(P){var c=a.getBoundingClientRect();p.movePointer(b.clientX-c.left,b.clientY-c.top)}}function i(a){P&&0===a.button&&p.endPointer()}function j(a,b){if(P&&b.touches.length>0&&!O){var c=b.touches[0],d=a.getBoundingClientRect();p.startPointer(c.clientX-d.left,c.clientY-d.top),F=c.identifier}}function k(a,b){for(var c=0;c<b.changedTouches.length&&O;++c){var d=b.changedTouches[c];if(d.identifier===F){var e=a.getBoundingClientRect();p.movePointer(d.clientX-e.left,d.clientY-e.top);break}}}function l(a){for(var b=0;b<a.changedTouches.length&&O;++b){var c=a.changedTouches[b];c.identifier===F&&p.endPointer()}}function m(a){if(a)for(var b in a)if(a.hasOwnProperty(b)){var c=a[b];c instanceof Function||(c=p.insertAtCursor.bind(p,c)),I[b]=c}}function n(){u&&r&&t&&(I={}),m.call(p,u),m.call(p,r),m.call(p,s),m.call(p,t)}function o(a){var b=a.toLowerCase();p["cursor"+a]=function(a,c){Q=!0,c[b](a),p.scrollIntoView(c)}}var p=this;b=b||{};var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I={},J="",K="",L=[],M=[],N=-1,O=!1,P=!1,Q=!1,R=!1,S=1,T=1,U=1,V=cascadeElement(a,"canvas",HTMLCanvasElement),W=V.getContext("2d"),X=cascadeElement("primrose-surrogate-textarea-"+a,"textarea",HTMLTextAreaElement);p.frontCursor=new Cursor,p.backCursor=new Cursor,p.scrollTop=0,p.scrollLeft=0,p.gridLeft=0,p.currentToken=null,["Left","Right","SkipLeft","SkipRight","Up","Down","Home","End","FullHome","FullEnd"].map(o.bind(p)),p.cursorPageUp=function(a,b){Q=!0,b.incY(-y,a),p.scrollIntoView(b)},p.cursorPageDown=function(a,b){Q=!0,b.incY(y,a),p.scrollIntoView(b)},p.focus=function(){Q=!0,P=!0},p.blur=function(){Q=!0,P=!1},p.isFocused=function(){return P},p.getCanvas=function(){return V},p.getTexture=function(a){return window.THREE&&!G&&(G=new THREE.Texture(V),G.anisotropy=a||8,G.needsUpdate=!0),G},p.setShowLineNumbers=function(a){R=a,Q=!0,p.drawText()},p.getShowLineNumbers=function(){return R},p.setTheme=function(a){x=a||Themes.DEFAULT,e.call(p)},p.getTheme=function(){return x},p.setDeadKeyState=function(a){Q=!0,J=a||""},p.setCommandState=function(a){Q=!0,K=a||""},p.setOperatingSystem=function(a){Q=!0,r=a||(isOSX?OperatingSystems.OSX:OperatingSystems.WINDOWS),n.call(p)},p.getOperatingSystem=function(){return r},p.setCommandSystem=function(a){Q=!0,t=a||Commands.DEFAULT,n.call(p)},p.setSize=function(a,b){V.style.width=a+"px",V.style.height=b+"px",e.call(p)},p.forceUpdate=function(){Q=!0,p.drawText()},p.getWidth=function(){return V.width},p.getHeight=function(){return V.height},p.setCodePage=function(a){Q=!0;var b,c,d=navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage||navigator.browserLanguage;if(d&&"en"!==d||(d="en-US"),q=a,!q){for(b in CodePages)if(a=CodePages[b],a.language===d){q=a;break}q||(q=CodePages.EN_US)}L=[];for(b in Keys)c=Keys[b],isNaN(c)||(L[c]=b);u={};for(var e in q){var f=q[e];if("object"==typeof f)for(c in f){var g,h;if(c.indexOf("_")>-1){var i=c.split(" "),j=i[0];c=i[1],g=q.NORMAL[c],h=j+"_"+e+" "+g}else g=q.NORMAL[c],h=e+"_"+g;L[c]=g,u[h]=f[c]}}n.call(p)},p.getCodePage=function(){return q},p.setTokenizer=function(a){Q=!0,v=a||Grammar.JavaScript,M&&M.length>0&&(w=v.tokenize(p.getText()),p.drawText&&p.drawText())},p.getTokenizer=function(){return v},p.getLines=function(){return M[N].slice()},p.pushUndo=function(a){Q=!0,N<M.length-1&&M.splice(N+1),M.push(a),N=M.length-1,w=v.tokenize(p.getText()),p.drawText()},p.redo=function(){Q=!0,N<M.length-1&&++N,w=v.tokenize(p.getText())},p.undo=function(){Q=!0,N>0&&--N,w=v.tokenize(p.getText())},p.setTabWidth=function(a){D=a||4,E="";for(var b=0;D>b;++b)E+=" "},p.getTabWidth=function(){return D},p.getTabString=function(){return E},p.scrollIntoView=function(a){p.scrollTop+=c(a.y,p.scrollTop,p.scrollTop+A),p.scrollLeft+=c(a.x,p.scrollLeft,p.scrollLeft+z)},p.increaseFontSize=function(){++x.fontSize,e.call(p)},p.decreaseFontSize=function(){x.fontSize>1&&(--x.fontSize,e.call(p))},p.getText=function(){return p.getLines().join("\n")},p.setText=function(a){a=a||"",a=a.replace(/\r\n/g,"\n");var b=a.split("\n");p.pushUndo(b),p.drawText&&p.drawText()},p.pixel2cell=function(a,b){var c=p.getPixelRatio();return a=Math.floor(a*c/p.characterWidth)+p.scrollLeft-p.gridLeft,b=Math.floor(b*c/p.characterHeight-.25)+p.scrollTop,{x:a,y:b}},p.cell2i=function(a,b){for(var c=p.getLines(),d=0,e=0;b>e;++e)d+=c[e].length+1;return d+=a},p.i2cell=function(a){for(var b=p.getLines(),c=0;c<b.length;++c){if(a<=b.length)return{x:a,y:c};a-=b.length-1}},p.getPixelRatio=function(){return window.devicePixelRatio||1},p.deleteSelection=function(){if(p.frontCursor.i!==p.backCursor.i){var a=Cursor.min(p.frontCursor,p.backCursor),b=Cursor.max(p.frontCursor,p.backCursor),c=p.getLines(),d=c.join("\n"),e=d.substring(0,a.i),f=d.substring(b.i);d=e+f,b.copy(a),p.setText(d)}},p.insertAtCursor=function(a){if(a.length>0){a=a.replace(/\r\n/g,"\n"),p.deleteSelection();var b=p.getLines(),c=a.split("\n");c[0]=b[p.frontCursor.y].substring(0,p.frontCursor.x)+c[0],c[c.length-1]+=b[p.frontCursor.y].substring(p.frontCursor.x),b.splice.bind(b,p.frontCursor.y,1).apply(b,c);for(var d=0;d<a.length;++d)p.frontCursor.right(b);p.backCursor.copy(p.frontCursor),p.scrollIntoView(p.frontCursor),p.pushUndo(b)}},p.pasteAtCursor=function(a){p.insertAtCursor(a),p.drawText()},p.copySelectedText=function(a){if(p.frontCursor.i!==p.backCursor.i){var b=Cursor.min(p.frontCursor,p.backCursor),c=Cursor.max(p.frontCursor,p.backCursor),d=p.getLines(),e=d.join("\n"),f=e.substring(b.i,c.i);a.clipboardData.setData("text/plain",f)}a.preventDefault()},p.cutSelectedText=function(a){p.copySelectedText(a),p.deleteSelection(),p.drawText()},p.placeSurrogateUnder=function(a){X&&a&&setTimeout(function(){var b=a.getBoundingClientRect();X.style.left=b.left+"px",X.style.top=window.scrollY+b.top+"px",X.style.width=b.right-b.left+"px",X.style.height=b.bottom-b.top+"px"},250)},p.incCurrentToken=function(a){if(p.currentToken&&"numbers"===p.currentToken.type){var b=parseFloat(p.currentToken.value),c=Math.pow(10,Math.floor(Math.log10(Math.abs(b))));c>=1?c/=10:c||(c=.1),b+=a*c;var d=p.getText(),e=d.substring(0,p.currentToken.index),f=d.substring(p.currentToken.index+p.currentToken.value.length);if(1>c){var g=Math.ceil(-Math.log10(1.1*c));console.log(b,c,g),console.log(b.toFixed(g)),d=e+b.toFixed(g)+f}else d=e+b.toString()+f;p.setText(d)}},p.editText=function(a){a=a||event;var b=a.keyCode;if(b!==Keys.CTRL&&b!==Keys.ALT&&b!==Keys.META_L&&b!==Keys.META_R&&b!==Keys.SHIFT){var c=J,d=J;a.ctrlKey&&(d+="CTRL"),a.altKey&&(d+="ALT"),a.metaKey&&(d+="META"),a.shiftKey&&(d+="SHIFT"),d===J&&(d+="NORMAL"),d+="_"+L[b];var e=I[s+"_"+d]||I[d];if(e){p.frontCursor.moved=!1,p.backCursor.moved=!1;var f=p.getLines();e.call(null,p,f),f=p.getLines(),p.frontCursor.moved&&!p.backCursor.moved&&p.backCursor.copy(p.frontCursor),p.frontCursor.rectify(f),p.backCursor.rectify(f),a.preventDefault()}J===c&&(J="")}p.drawText()},p.drawText=function(){if(Q&&x&&w){var a,b=x.regular.backColor?"fillRect":"clearRect";x.regular.backColor&&(W.fillStyle=x.regular.backColor),W[b](0,0,W.canvas.width,W.canvas.height);for(var c=[[]],d=0;d<w.length;++d)a=w[d],c[c.length-1].push(a),"newlines"===a.type&&c.push([]);var e=0;p.gridLeft=S,R&&(e=Math.max(1,Math.ceil(Math.log(c.length)/Math.LN10)),p.gridLeft+=e),z=Math.floor(V.width/p.characterWidth)-p.gridLeft-T;var f=p.scrollLeft+z;A=Math.floor(V.height/p.characterHeight)-U,y=Math.floor(A);var g=Cursor.min(p.frontCursor,p.backCursor),h=Cursor.max(p.frontCursor,p.backCursor),i=new Cursor,j=new Cursor,k=0;p.currentToken=null;for(var l=0;l<c.length;++l){for(var m=c[l],n=0;n<m.length;++n){a=m[n];var o=a.value;if(j.x+=o.length,j.i+=o.length,p.scrollTop<=l&&l<p.scrollTop+A&&p.scrollLeft<=j.x&&i.x<f){if(g.i<=j.i&&i.i<h.i){g.i===h.i&&(p.currentToken=a);var q=Cursor.max(g,i),r=Cursor.min(h,j),s=r.i-q.i;W.fillStyle=x.regular.selectedBackColor||Themes.DEFAULT.regular.selectedBackColor,W.fillRect((q.x-p.scrollLeft+p.gridLeft)*p.characterWidth,(q.y-p.scrollTop+.2)*p.characterHeight,s*p.characterWidth+1,p.characterHeight+1)}var t=x[a.type]||{},u=(t.fontWeight||x.regular.fontWeight||"")+" "+(t.fontStyle||x.regular.fontStyle||"")+" "+p.characterHeight+"px "+x.fontFamily;W.font=u.trim(),W.fillStyle=t.foreColor||x.regular.foreColor,W.fillText(o,(i.x-p.scrollLeft+p.gridLeft)*p.characterWidth,(i.y-p.scrollTop+1)*p.characterHeight)}i.copy(j)}if(R&&p.scrollTop<=l&&l<p.scrollTop+A){for(var v=l.toString();v.length<e;)v=" "+v;W.fillStyle=x.regular.selectedBackColor||Themes.DEFAULT.regular.selectedBackColor,W.fillRect(0,(l-p.scrollTop+.2)*p.characterHeight,(v.length+S)*p.characterWidth,p.characterHeight),W.font="bold "+p.characterHeight+"px "+x.fontFamily,W.fillStyle=x.regular.foreColor,W.fillText(v,0,(l-p.scrollTop+1)*p.characterHeight)}k=Math.max(k,j.x),i.x=0,++i.y,j.copy(i)}P&&(W.beginPath(),W.strokeStyle=x.cursorColor||"black",W.moveTo((p.frontCursor.x-p.scrollLeft+p.gridLeft)*p.characterWidth,(p.frontCursor.y-p.scrollTop)*p.characterHeight),W.lineTo((p.frontCursor.x-p.scrollLeft+p.gridLeft)*p.characterWidth,(p.frontCursor.y-p.scrollTop+1.25)*p.characterHeight),W.moveTo((p.backCursor.x-p.scrollLeft+p.gridLeft)*p.characterWidth+1,(p.backCursor.y-p.scrollTop)*p.characterHeight),W.lineTo((p.backCursor.x-p.scrollLeft+p.gridLeft)*p.characterWidth+1,(p.backCursor.y-p.scrollTop+1.25)*p.characterHeight),W.stroke());var B=p.scrollTop*V.height/c.length,C=A*V.height/c.length-U*p.characterHeight;W.fillStyle=x.regular.selectedBackColor||Themes.DEFAULT.regular.selectedBackColor,W.fillRect(V.width-p.characterWidth,B,p.characterWidth,C);var D=p.scrollLeft*V.width/k+p.gridLeft*p.characterWidth,E=z*V.width/k-(p.gridLeft+T)*p.characterWidth;W.fillStyle=x.regular.selectedBackColor||Themes.DEFAULT.regular.selectedBackColor,W.fillRect(D,A*p.characterHeight,E,p.characterWidth),G&&(G.needsUpdate=!0),Q=!1}},p.readWheel=function(a){P&&(Q=!0,p.scrollTop+=Math.floor(a.deltaY/p.characterHeight),p.scrollTop<0&&(p.scrollTop=0),a.preventDefault(),p.drawText())},p.startPointer=function(a,b){f.call(p,p.frontCursor,a,b),p.backCursor.copy(p.frontCursor),O=!0,p.drawText()},p.movePointer=function(a,b){O&&(f.call(p,p.backCursor,a,b),p.drawText())},p.endPointer=function(){O=!1,X.focus()},p.bindEvents=function(a,b){a&&a.addEventListener("keydown",p.editText.bind(p)),b&&(b.addEventListener("wheel",p.readWheel.bind(p)),b.addEventListener("mousedown",g.bind(p,b)),b.addEventListener("mousemove",h.bind(p,b)),b.addEventListener("mouseup",i.bind(p)),b.addEventListener("touchstart",j.bind(p,b)),b.addEventListener("touchmove",k.bind(p,b)),b.addEventListener("touchend",l.bind(p)))},s=isChrome?"CHROMIUM":isFirefox?"FIREFOX":isIE?"IE":isOpera?"OPERA":isSafari?"SAFARI":"UNKNOWN",a instanceof HTMLCanvasElement||!b.width||!b.height||(V.style.position="absolute",V.style.width=b.width,V.style.height=b.height),X.style.position="absolute",H=makeHidingContainer("primrose-surrogate-textarea-container-"+a,X),V.parentElement||document.body.appendChild(makeHidingContainer("primrose-container-"+a,V)),document.body.appendChild(H),p.setShowLineNumbers(!b.hideLineNumbers),p.setTabWidth(b.tabWidth),p.setTheme(b.theme),p.setTokenizer(b.tokenizer),p.setCodePage(b.codePage),p.setOperatingSystem(b.os),p.setCommandSystem(b.commands),p.setText(b.file),p.bindEvents(b.keyEventSource,b.pointerEventSource),p.themeSelect=makeSelectorFromObj("primrose-theme-selector-"+a,Themes,x.name,p,"setTheme","theme"),p.tokenizerSelect=makeSelectorFromObj("primrose-tokenizer-selector-"+a,Grammar,v.name,p,"setTokenizer","language syntax"),p.keyboardSelect=makeSelectorFromObj("primrose-keyboard-selector-"+a,CodePages,q.name,p,"setCodePage","localization"),p.commandSystemSelect=makeSelectorFromObj("primrose-command-system-selector-"+a,Commands,t.name,p,"setCommandSystem","command system"),p.operatingSystemSelect=makeSelectorFromObj("primrose-operating-system-selector-"+a,OperatingSystems,r.name,p,"setOperatingSystem","shortcut style"),window.addEventListener("resize",e.bind(p)),X.addEventListener("copy",p.copySelectedText.bind(p)),X.addEventListener("cut",p.cutSelectedText.bind(p)),X.addEventListener("paste",d.bind(p))}function makeURL(a,b){var c=[];for(var d in b)!b.hasOwnProperty(d)||b[d]instanceof Function||c.push(encodeURIComponent(d)+"="+encodeURIComponent(b[d]));return a+"?"+c.join("&")}function XHR(a,b,c,d,e,f,g){var h=new XMLHttpRequest;h.onerror=e,h.onabort=e,h.onprogress=d,h.onload=function(){h.status<400?f&&f(h.response):e&&e()},h.open(b,a),c&&(h.responseType=c),g?(h.setRequestHeader("Content-Type","application/json;charset=UTF-8"),h.send(JSON.stringify(g))):h.send()}function GET(a,b,c,d,e){b=b||"text",XHR(a,"GET",b,c,d,e)}function POST(a,b,c,d,e,f){XHR(a,"POST",c,d,e,f,b)}function getObject(a,b,c,d){var e=d&&c&&b,f=d&&c||c&&b,g=d||c||b;GET(a,"json",e,f,g)}function sendObject(a,b,c,d,e){POST(a,b,"json",e&&d&&c,e&&d||d&&c,e||d||c)}function XXX(a,b){return new Error(fmt("$1. Was given $2$3$2",a,b?'"':"",b))}function E(a,b,c){if(!a||!a.addEventListener)throw XXX("must supply an element with an addEventListener method",a);if(!b||"string"!=typeof b)throw XXX("must provide the name of an event",b);c||(c=console.log.bind(console,fmt("$1.$2",a.tagName,b))),a.addEventListener(b,c)}function arr(a,b,c){return Array.prototype.slice.call(a,b,c)}function map(a,b){return Array.prototype.map.call(a,b)}function reduce(a,b,c){return Array.prototype.reduce.call(a,b,c)}function filter(a,b){return Array.prototype.filter.call(a,b)}function ofType(a,b){return"function"==typeof b?filter(a,function(a){return a instanceof b}):filter(a,function(a){return typeof a===b})}function agg(a,b,c){return"function"!=typeof b&&(b=function(a,b){return b[a]}.bind(window,b)),a.map(b).reduce(c)}function add(a,b){return a+b}function sum(a,b){return agg(a,b,add)}function group(a,b,c){var d=[],e=a.slice();e.sort(function(a,c){var d=b?b(a):a,e=b?b(c):c;return e>d?-1:d>e?1:0});for(var f=0;f<e.length;++f){var g=e[f],h=b?b(g):g,i=c?c(g):g;(0===d.length||d[d.length-1].key!==h)&&d.push({key:h,values:[]}),d[d.length-1].values.push(i)}return d}function help(a){var b={},c={},d=[];if(a){for(var e in a)0!==e.indexOf("on")||a===navigator&&"onLine"===e?"function"==typeof a[e]?b[e]=a[e]:c[e]=a[e]:d.push(e.substring(2));var f=typeof a;if("function"===f)f=a.toString().match(/(function [^(]*)/)[1];else if("object"===f)if(f=null,a.constructor&&a.constructor.name)f=a.constructor.name;else{for(var g=[{prefix:"",obj:window}],h=[];g.length>0&&null===f;){var i=g.shift();i.___traversed___=!0,h.push(i);for(e in i.obj){var j=i.obj[e];if(j)if("function"==typeof j){if(j.prototype&&a instanceof j){f=i.prefix+e;break}}else j.___tried___||g.push({prefix:i.prefix+e+".",obj:j})}}h.forEach(function(a){delete a.___traversed___})}return a={type:f,events:d,functions:b,properties:c},console.debug(a),a}console.warn("Object was falsey.")}function cascadeElement(a,b,c){var d=null;if(null===a?d=document.createElement(b):void 0===c||a instanceof c?d=a:"string"==typeof a&&(d=document.getElementById(a),null===d?(d=document.createElement(b),d.id=a):d.tagName!==b.toUpperCase()&&(d=null)),null===d)throw new Error(a+" does not refer to a valid "+b+" element.");return d.innerHTML="",d}function fmt(a){var b=/\$(0*)(\d+)(?:\.(0+))?/g,c=arguments;return a.replace(b,function(a,b,d,e){if(d=parseInt(d,10),d>=0&&d<c.length){var f=c[d];if(null!==f&&void 0!==f){if(f instanceof Date&&e){switch(e.length){case 1:f=f.getYear();break;case 2:f=f.getMonth()+1+"/"+f.getYear();break;case 3:f=f.toLocaleDateString();break;case 4:f=fmt.addMillis(f,f.toLocaleTimeString());break;case 5:case 6:f=f.toLocaleString();break;default:f=fmt.addMillis(f,f.toLocaleString())}return f}if(f=e&&e.length>0?sigfig(f,e.length):f.toString(),b&&b.length>0)for(var g=new RegExp("^\\d{"+(b.length+1)+"}(\\.\\d+)?");!g.test(f);)f="0"+f;return f}}return void 0})}function sigfig(a,b){var c=Math.pow(10,b),d=(Math.round(a*c)/c).toString();if(b>0){var e=d.indexOf(".");for(-1===e&&(d+=".",e=d.length-1);d.length-e-1<b;)d+="0"}return d}function findEverything(a,b){a=a||document,b=b||{};for(var c=a.querySelectorAll("*"),d=0;d<c.length;++d){var e=c[d];e.id&&e.id.length>0&&(b[e.id]=e,e.parentElement&&(e.parentElement[e.id]=e))}return b}function inherit(a,b){a.prototype=Object.create(b.prototype),a.prototype.constructor=a}function getSetting(a,b){if(window.localStorage){var c=window.localStorage.getItem(a);if(c)try{return JSON.parse(c)}catch(d){console.error("getSetting",a,c,typeof c,d)}}return b}function setSetting(a,b){if(window.localStorage&&b)try{window.localStorage.setItem(a,JSON.stringify(b))}catch(c){console.error("setSetting",a,b,typeof b,c)}}function deleteSetting(a){window.localStorage&&window.localStorage.removeItem(a)}function readForm(a){var b={};if(a)for(var c in a){var d=a[c];"INPUT"!==d.tagName&&"SELECT"!==d.tagName||d.dataset&&d.dataset.skipcache||("text"===d.type||"password"===d.type||"SELECT"===d.tagName?b[c]=d.value:("checkbox"===d.type||"radio"===d.type)&&(b[c]=d.checked))}return b}function writeForm(a,b){if(b)for(var c in a){var d=a[c];null===b[c]||void 0===b[c]||"INPUT"!==d.tagName&&"SELECT"!==d.tagName||d.dataset&&d.dataset.skipcache||("text"===d.type||"password"===d.type||"SELECT"===d.tagName?d.value=b[c]:("checkbox"===d.type||"radio"===d.type)&&(d.checked=b[c]))}}function reloadPage(){document.location=document.location.href}function makeSelectorFromObj(a,b,c,d,e,f){var g=cascadeElement(a,"select",HTMLSelectElement),h=[];for(var i in b)if(b.hasOwnProperty(i)){var j=document.createElement("option"),k=b[i].name||i;j.innerHTML=k,h.push(b[i]),k===c&&(j.selected="selected"),g.appendChild(j)}d[e]instanceof Function?E(g,"change",function(){d[e](h[g.selectedIndex])}):E(g,"change",function(){d[e]=h[g.selectedIndex]});var l=cascadeElement("container -"+a,"div",HTMLDivElement),m=cascadeElement("label-"+a,"span",HTMLSpanElement);return m.innerHTML=" - "+f,m["for"]=g,g.title=f,g.alt=f,l.appendChild(g),l.appendChild(m),l}function makeHidingContainer(a,b){var c=cascadeElement(a,"div",HTMLDivElement);return c.style.position="absolute",c.style.left=0,c.style.top=0,c.style.width=0,c.style.height=0,c.style.overflow="hidden",c.appendChild(b),c}function isFullScreenMode(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}function requestFullScreen(a,b){if(a instanceof Function&&(b=a,a=null),isFullScreenMode())b&&b();else{document.documentElement.requestFullscreen(a?{vrDisplay:a}:Element.ALLOW_KEYBOARD_INPUT);var c=setInterval(function(){isFullScreenMode()&&(clearInterval(c),screen.lockOrientation("landscape-primary"),b&&b())},1e3)}}function exitFullScreen(){isFullScreenMode()&&document.exitFullscreen()}function toggleFullScreen(){document.documentElement.requestFullscreen&&(isFullScreenMode()?exitFullScreen():requestFullScreen())}function addFullScreenShim(){function a(){c.forEach(function(a){a.events.forEach(function(c){a.elem.removeEventListener(c,b)})})}function b(){requestFullScreen(a)}var c=arr(arguments);c=c.map(function(a){return{elem:a,events:help(a).events}}),c.forEach(function(a){a.events.forEach(function(c){c.indexOf("fullscreenerror")<0&&a.elem.addEventListener(c,b,!1)})})}function isPointerLocked(){return!!(document.pointerLockElement||document.webkitPointerLockElement||document.mozPointerLockElement)}Cursor.min=function(a,b){return a.i<=b.i?a:b},Cursor.max=function(a,b){return a.i>b.i?a:b},Cursor.prototype.toString=function(){return fmt("[i:$1 x:$2 y:$3]",this.i,this.x,this.y)},Cursor.prototype.copy=function(a){this.i=a.i,this.x=a.x,this.y=a.y,this.moved=!1},Cursor.prototype.rectify=function(a){this.y>=a.length&&(this.y=a.length-1),this.x>a[this.y].length&&(this.x=a[this.y].length)},Cursor.prototype.left=function(a){this.i>0&&(--this.i,--this.x,this.x<0&&(--this.y,this.x=a[this.y].length)),this.moved=!0},Cursor.prototype.skipleft=function(a){if(0===this.x)this.left(a);else{var b=this.x-1,c=reverse(a[this.y].substring(0,b)),d=c.match(/(\s|\W)+/),e=d?d.index+d[0].length+1:c.length+1;this.i-=e,this.x-=e}this.moved=!0},Cursor.prototype.right=function(a){(this.y<a.length-1||this.x<a[this.y].length)&&(++this.i,++this.x,this.x>a[this.y].length&&(this.x=0,++this.y)),this.moved=!0},Cursor.prototype.skipright=function(a){if(this.x===a[this.y].length)this.right(a);else{var b=this.x+1,c=a[this.y].substring(b),d=c.match(/(\s|\W)+/),e=d?d.index+d[0].length+1:c.length-this.x;this.i+=e,this.x+=e}this.moved=!0},Cursor.prototype.home=function(){this.i-=this.x,this.x=0,this.moved=!0},Cursor.prototype.fullhome=function(){this.i=0,this.x=0,this.y=0,this.moved=!0},Cursor.prototype.end=function(a){var b=a[this.y].length-this.x;this.i+=b,this.x+=b,this.moved=!0},Cursor.prototype.fullend=function(a){for(this.i+=a[this.y].length-this.x;this.y<a.length-1;)++this.y,this.i+=a[this.y].length+1;this.x=a[this.y].length,this.moved=!0},Cursor.prototype.up=function(a){if(this.y>0){--this.y;var b=Math.min(0,a[this.y].length-this.x);this.x+=b,this.i-=a[this.y].length+1-b}this.moved=!0},Cursor.prototype.down=function(a){if(this.y<a.length-1){++this.y;var b=Math.min(0,a[this.y].length-this.x);this.x+=b,this.i+=a[this.y-1].length+1+b}this.moved=!0},Cursor.prototype.setXY=function(a,b,c){this.y=Math.max(0,Math.min(c.length-1,b)),this.x=Math.max(0,Math.min(c[this.y].length,a)),this.i=this.x;for(var d=0;d<this.y;++d)this.i+=c[d].length+1;this.moved=!0},Cursor.prototype.incY=function(a,b){this.y=Math.max(0,Math.min(b.length-1,this.y+a)),this.x=Math.max(0,Math.min(b[this.y].length,this.x)),this.i=this.x;for(var c=0;c<this.y;++c)this.i+=b[c].length+1;this.moved=!0},Grammar.prototype.tokenize=function(a){for(var b=[new Token(a,"regular",0)],c=0;c<this.grammar.length;++c)for(var d=this.grammar[c],e=0;e<b.length;++e){var f=b[e];if("regular"===f.type){var g=d.test.exec(b[e].value);if(g){var h=g[g.length-1],i=g.index;2===g.length&&(i+=g[0].indexOf(h));var j=new Token(h,d.name,f.index+i);b.splice(e+1,0,j);var k=i+h.length;if(k<f.value.length){var l=new Token(f.value.substring(k),"regular",f.index+k);b.splice(e+2,0,l)}i>0?(f.value=f.value.substring(0,i),++e):b.splice(e,1)}}}var m=!1;for(c=0;c<b.length;++c){var n=b[c];m?("endBlockComments"===n.type&&(m=!1),"newlines"!==n.type&&(n.type="comments")):"startBlockComments"===n.type&&(m=!0,n.type="comments")}return b};var CodePages={},Themes={},Commands={},OperatingSystems={},Keys={MODIFIER_KEYS:["CTRL","ALT","META","SHIFT"],SHIFT:16,CTRL:17,ALT:18,META_L:91,META_R:92,BACKSPACE:8,TAB:9,ENTER:13,SPACEBAR:32,DELETE:46,PAUSEBREAK:19,CAPSLOCK:20,NUMLOCK:144,SCROLLLOCK:145,INSERT:45,ESCAPE:27,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFTARROW:37,UPARROW:38,RIGHTARROW:39,DOWNARROW:40,SELECTKEY:93,NUMPAD0:96,NUMPAD1:97,NUMPAD2:98,NUMPAD3:99,NUMPAD4:100,NUMPAD5:101,NUMPAD6:102,NUMPAD7:103,NUMPAD8:104,NUMPAD9:105,MULTIPLY:106,ADD:107,SUBTRACT:109,DECIMALPOINT:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,setCursorCommand:function(a,b,c,d,e){var f=b+"_"+c;a[f]=function(a,b){a["cursor"+d](b,a[e+"Cursor"])}},makeCursorCommand:function(a,b,c,d){Keys.setCursorCommand(a,b||"NORMAL",c,d,"front"),Keys.setCursorCommand(a,b+"SHIFT",c,d,"back")},addNumPad:function(a){for(var b=0;9>=b;++b){var c=Keys["NUMPAD"+b];a.NORMAL[c]=b.toString()}}};for(var key in Keys){var val=Keys[key];Keys.hasOwnProperty(key)&&"number"==typeof val&&(Keys[val]=key)}CodePages.DE_QWERTZ={name:"Deutsch: QWERTZ",language:"de",deadKeys:[220,221,160,192],NORMAL:{48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",60:"<",63:"ß",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",160:function(a){a.setDeadKeyState("DEAD3")},163:"#",171:"+",173:"-",186:"ü",187:"+",188:",",189:"-",190:".",191:"#",192:function(a){a.setDeadKeyState("DEAD4")},219:"ß",220:function(a){a.setDeadKeyState("DEAD1")},221:function(a){a.setDeadKeyState("DEAD2")},222:"ä",226:"<"},DEAD1NORMAL:{65:"â",69:"ê",73:"î",79:"ô",85:"û",190:"."},DEAD2NORMAL:{65:"á",69:"é",73:"í",79:"ó",83:"s",85:"ú",89:"ý"},SHIFT:{48:"=",49:"!",50:'"',51:"§",52:"$",53:"%",54:"&",55:"/",56:"(",57:")",60:">",63:"?",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",163:"'",171:"*",173:"_",186:"Ü",187:"*",188:";",189:"_",190:":",191:"'",192:"Ö",219:"?",222:"Ä",226:">"},CTRLALT:{48:"}",50:"²",51:"³",55:"{",56:"[",57:"]",60:"|",63:"\\",69:"€",77:"µ",81:"@",171:"~",187:"~",219:"\\",226:"|"},CTRLALTSHIFT:{63:"ẞ",219:"ẞ"},DEAD3NORMAL:{65:"a",69:"e",73:"i",79:"o",85:"u",190:"."},DEAD4NORMAL:{65:"a",69:"e",73:"i",79:"o",83:"s",85:"u",89:"y"}},Keys.addNumPad(CodePages.DE_QWERTZ),CodePages.EN_UKX={name:"English: UK Extended",language:"en-GB",CTRLALT:{52:"€",65:"á",69:"é",73:"í",79:"ó",85:"ú",163:"\\",192:"¦",222:"\\",223:"¦"},CTRLALTSHIFT:{65:"Á",69:"É",73:"Í",79:"Ó",85:"Ú",222:"|"},NORMAL:{48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",163:"#",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"'",219:"[",220:"\\",221:"]",222:"#",223:"`"},SHIFT:{48:")",49:"!",50:'"',51:"£",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",163:"~",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"@",219:"{",220:"|",221:"}",222:"~",223:"¬"}},Keys.addNumPad(CodePages.EN_UKX),CodePages.EN_US={name:"English: USA",language:"en-US",NORMAL:{48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",219:"[",220:"\\",221:"]",222:"'"},SHIFT:{48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",219:"{",220:"|",221:"}",222:'"'}},Keys.addNumPad(CodePages.EN_US),CodePages.FR_AZERTY={name:"Français: AZERTY",language:"fr",deadKeys:[221,50,55],NORMAL:{48:"à",49:"&",50:"é",51:'"',52:"'",53:"(",54:"-",55:"è",56:"_",57:"ç",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",186:"$",187:"=",188:",",190:";",191:":",192:"ù",219:")",220:"*",221:function(a){a.setDeadKeyState("DEAD1")},222:"²",223:"!",226:"<"},SHIFT:{48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",186:"£",187:"+",188:"?",190:".",191:"/",192:"%",219:"°",220:"µ",223:"§",226:">"},CTRLALT:{48:"@",50:function(a){a.setDeadKeyState("DEAD2")},51:"#",52:"{",53:"[",54:"|",55:function(a){a.setDeadKeyState("DEAD3")},56:"\\",57:"^",69:"€",186:"¤",187:"}",219:"]"},DEAD1NORMAL:{65:"â",69:"ê",73:"î",79:"ô",85:"û"},DEAD2NORMAL:{65:"ã",78:"ñ",79:"õ"},DEAD2CTRLALT:{50:function(a){a.setDeadKeyState("DEAD2")},55:function(a){a.setDeadKeyState("DEAD3")}},DEAD1CTRLALT:{50:function(a){a.setDeadKeyState("DEAD2")}},DEAD3NORMAL:{48:"à",50:"é",55:"è",65:"à",69:"è",73:"ì",79:"ò",85:"ù"}},Keys.addNumPad(CodePages.FR_AZERTY),Commands.DEFAULT={name:"Basic commands",NORMAL_SPACEBAR:" ",SHIFT_SPACEBAR:" ",NORMAL_BACKSPACE:function(a,b){a.frontCursor.i===a.backCursor.i&&a.frontCursor.left(b),a.deleteSelection(),a.scrollIntoView(a.frontCursor)},NORMAL_ENTER:function(a,b){for(var c="",d=0;d<b[a.frontCursor.y].length&&" "===b[a.frontCursor.y][d];++d)c+=" ";a.insertAtCursor("\n"+c),a.scrollIntoView(a.frontCursor)},NORMAL_DELETE:function(a,b){a.frontCursor.i===a.backCursor.i&&a.backCursor.right(b),a.deleteSelection(),a.scrollIntoView(a.frontCursor)},SHIFT_DELETE:function(a,b){a.frontCursor.i===a.backCursor.i&&(a.frontCursor.home(b),a.backCursor.end(b)),a.deleteSelection(),a.scrollIntoView(a.frontCursor)},NORMAL_TAB:function(a,b){var c=a.getTabString();if(a.frontCursor.y===a.backCursor.y)a.insertAtCursor(c);else{var d=Cursor.min(a.frontCursor,a.backCursor),e=Cursor.max(a.frontCursor,a.backCursor);d.home(b),e.end(b);for(var f=d.y;f<=e.y;++f)b[f]=c+b[f];d.setXY(0,d.y,b),e.setXY(0,e.y,b),e.end(b),a.pushUndo(b)}a.scrollIntoView(a.frontCursor)},SHIFT_TAB:function(a,b){var c=Cursor.min(a.frontCursor,a.backCursor),d=Cursor.max(a.frontCursor,a.backCursor);c.home(b),d.home(b);for(var e=a.getTabWidth(),f=a.getTabString(),g=!1,h=c.y;h<=d.y;++h)b[h].substring(0,e)===f&&(b[h]=b[h].substring(e),g=!0);g&&(c.setXY(0,c.y,b),d.setXY(0,d.y,b),d.end(b),a.pushUndo(b),a.scrollIntoView(a.frontCursor))}},Keys.makeCursorCommand(Commands.DEFAULT,"","LEFTARROW","Left"),Keys.makeCursorCommand(Commands.DEFAULT,"","RIGHTARROW","Right"),Keys.makeCursorCommand(Commands.DEFAULT,"","UPARROW","Up"),Keys.makeCursorCommand(Commands.DEFAULT,"","DOWNARROW","Down"),Keys.makeCursorCommand(Commands.DEFAULT,"","PAGEUP","PageUp"),Keys.makeCursorCommand(Commands.DEFAULT,"","PAGEDOWN","PageDown");var reverse=function(a){a=a.replace(reverse.combiningMarks,function(a,b,c){return reverse(c)+b}).replace(reverse.surrogatePair,"$2$1");for(var b="",c=a.length-1;c>=0;--c)b+=a[c];return b};reverse.combiningMarks=/(<%= allExceptCombiningMarks %>)(<%= combiningMarks %>+)/g,reverse.surrogatePair=/(<%= highSurrogates %>)(<%= lowSurrogates %>)/g,fmt.addMillis=function(a,b){return b.replace(/( AM| PM|$)/,function(b,c){return(a.getMilliseconds()/1e3).toString().substring(1)+c})};var px=fmt.bind(this,"$1px"),pct=fmt.bind(this,"$1%"),ems=fmt.bind(this,"$1em"),isMobile=function(a){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substring(0,4))
}(navigator.userAgent||navigator.vendor||window.opera),isiOS=/Apple-iP(hone|od|ad)/.test(navigator.userAgent||""),isOSX=/Macintosh/.test(navigator.userAgent||""),isWindows=/Windows/.test(navigator.userAgent||""),isOpera=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,isFirefox="undefined"!=typeof InstallTrigger,isSafari=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,isChrome=!!window.chrome&&!isOpera,isIE=!1||!!document.documentMode;navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia,window.RTCPeerConnection=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,window.RTCIceCandidate=window.RTCIceCandidate||window.mozRTCIceCandidate||window.RTCIceCandidate,window.RTCSessionDescription=window.RTCSessionDescription||window.mozRTCSessionDescription||window.RTCSessionDescription,screen.lockOrientation=screen.lockOrientation||screen.mozLockOrientation||screen.msLockOrientation||function(){},document.documentElement.requestFullscreen||(document.documentElement.msRequestFullscreen?(document.documentElement.requestFullscreen=document.documentElement.msRequestFullscreen,document.exitFullscreen=document.msExitFullscreen):document.documentElement.mozRequestFullScreen?(document.documentElement.requestFullscreen=document.documentElement.mozRequestFullScreen,document.exitFullscreen=document.mozCancelFullScreen):document.documentElement.webkitRequestFullscreen&&(document.documentElement.requestFullscreen=document.documentElement.webkitRequestFullscreen,document.exitFullscreen=document.webkitExitFullscreen));var exitPointerLock=(document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock||function(){}).bind(document),requestPointerLock=(document.documentElement.requestPointerLock||document.documentElement.webkitRequestPointerLock||document.documentElement.mozRequestPointerLock||function(){}).bind(document.documentElement);Grammar.JavaScript=new Grammar("JavaScript",[["newlines",/(?:\r\n|\r|\n)/],["comments",/\/\/.*$/],["startBlockComments",/\/\*/],["endBlockComments",/\*\//],["strings",/"(?:\\"|[^"]*)"/],["strings",/'(?:\\'|[^']*)'/],["numbers",/-?(?:(?:\b\d*)?\.)?\b\d+\b/],["keywords",/\b(?:break|case|catch|const|continue|debugger|default|delete|do|else|export|finally|for|function|if|import|in|instanceof|let|new|return|super|switch|this|throw|try|typeof|var|void|while|with)\b/],["functions",/(\w+)(?:\s*\()/],["members",/(?:(?:\w+\.)+)(\w+)/]]),Grammar.PlainText=new Grammar("PlainText",[["newlines",/(?:\r\n|\r|\n)/]]),OperatingSystems.OSX={name:"OSX",META_a:function(a,b){a.frontCursor.fullhome(b),a.backCursor.fullend(b)},METASHIFT_z:function(a){a.redo(),a.scrollIntoView(a.frontCursor)},META_z:function(a){a.undo(),a.scrollIntoView(a.frontCursor)},META_DOWNARROW:function(a,b){a.scrollTop<b.length&&++a.scrollTop},META_UPARROW:function(a){a.scrollTop>0&&--a.scrollTop}},Keys.makeCursorCommand(OperatingSystems.OSX,"META","LEFTARROW","Home"),Keys.makeCursorCommand(OperatingSystems.OSX,"META","RIGHTARROW","End"),Keys.makeCursorCommand(OperatingSystems.OSX,"META","UPARROW","FullHome"),Keys.makeCursorCommand(OperatingSystems.OSX,"META","DOWNARROW","FullEnd"),Keys.makeCursorCommand(OperatingSystems.OSX,"ALT","RIGHTARROW","SkipRight"),Keys.makeCursorCommand(OperatingSystems.OSX,"ALT","LEFTARROW","SkipLeft"),OperatingSystems.WINDOWS={name:"Windows",CTRL_a:function(a,b){a.frontCursor.fullhome(b),a.backCursor.fullend(b),a.forceUpdate()},CTRL_y:function(a){a.redo(),a.scrollIntoView(a.frontCursor)},CTRL_z:function(a){a.undo(),a.scrollIntoView(a.frontCursor)},CTRL_DOWNARROW:function(a,b){a.scrollTop<b.length&&++a.scrollTop,a.forceUpdate()},CTRL_UPARROW:function(a){a.scrollTop>0&&--a.scrollTop,a.forceUpdate()},ALTSHIFT_LEFTARROW:function(a){a.incCurrentToken(-1)},ALTSHIFT_RIGHTARROW:function(a){a.incCurrentToken(1)}},Keys.makeCursorCommand(OperatingSystems.WINDOWS,"","HOME","Home"),Keys.makeCursorCommand(OperatingSystems.WINDOWS,"","END","End"),Keys.makeCursorCommand(OperatingSystems.WINDOWS,"CTRL","HOME","FullHome"),Keys.makeCursorCommand(OperatingSystems.WINDOWS,"CTRL","END","FullEnd"),Keys.makeCursorCommand(OperatingSystems.WINDOWS,"CTRL","RIGHTARROW","SkipRight"),Keys.makeCursorCommand(OperatingSystems.WINDOWS,"CTRL","LEFTARROW","SkipLeft"),Themes.Dark={name:"Dark",fontFamily:"monospace",cursorColor:"white",fontSize:14,regular:{backColor:"black",foreColor:"#c0c0c0",selectedBackColor:"#404040",selectedForeColor:"#ffffff"},strings:{foreColor:"#aa9900",fontStyle:"italic"},numbers:{foreColor:"green"},comments:{foreColor:"yellow",fontStyle:"italic"},keywords:{foreColor:"cyan"},functions:{foreColor:"brown",fontWeight:"bold"},members:{foreColor:"green"},error:{foreColor:"red",fontStyle:"underline italic"}},Themes.DEFAULT={name:"Light",fontFamily:"monospace",cursorColor:"black",fontSize:14,regular:{backColor:"white",foreColor:"black",selectedBackColor:"#c0c0c0",selectedForeColor:"#000000"},strings:{foreColor:"#aa9900",fontStyle:"italic"},numbers:{foreColor:"green"},comments:{foreColor:"grey",fontStyle:"italic"},keywords:{foreColor:"blue"},functions:{foreColor:"brown",fontWeight:"bold"},members:{foreColor:"green"},error:{foreColor:"red",fontStyle:"underline italic"}};